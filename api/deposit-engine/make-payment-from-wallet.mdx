---
title: 'Make Payment from Wallet'
api: 'POST https://remitjunction.fincode.software/api/v6/services/paymentmanagement/makepaymentfromwalletaccount'
description: 'Process payment for any payable item using customer wallet balance.'
---

## Overview

This endpoint allows customers to pay for transactions, bill payments, wallet funding, or any other payable item using their wallet balance. The system automatically debits the customer's wallet and updates the payment status.

<Info>
  This is the preferred payment method for instant, fee-free transactions when the customer has sufficient wallet balance.
</Info>

## Authentication

<ParamField header="X-Auth-Token" type="string" required>
  Authentication token obtained from login
</ParamField>

<ParamField header="uuid" type="string" required>
  Device UUID for request tracking
</ParamField>

<ParamField header="platform" type="string" required>
  Platform identifier (e.g., "WEB", "MOBILE", "IOS", "ANDROID")
</ParamField>

## Request Body

<ParamField body="payableType" type="enum" required>
  Type of payable item to process
  
  **Options:**
  - `TRANSACTION` - Remittance/money transfer
  - `WALLET` - Generic wallet payment
  - `WALLET_CUSTOMER` - Personal wallet payment
  - `BILL` - Bill payment
  - `MERCHANT` - Product payment
  - `WITHDRAWAL` - Wallet withdrawal
</ParamField>

<ParamField body="payAbleId" type="string" required>
  Unique identifier of the payable item
</ParamField>

<ParamField body="password" type="string" required>
  Customer's account password for authentication
</ParamField>

<ParamField body="accountId" type="string" required>
  Wallet account ID to debit from
</ParamField>

<ParamField body="totalCheckOutAmount" type="number" required>
  Total amount to be debited including fees and taxes
</ParamField>

<ParamField body="paymentGatewayRef" type="string" required>
  Reference number for the payment (can be auto-generated)
</ParamField>

<ParamField body="accountNumber" type="string">
  Specific wallet account number (if customer has multiple accounts)
</ParamField>

<ParamField body="paymentAccountNumbeCurrencyCode" type="enum">
  Currency code of the wallet account
  
  **Examples:** `USD`, `GBP`, `NGN`, `EUR`
</ParamField>

<ParamField body="otp" type="string">
  One-Time Password for Strong Customer Authentication (if enabled)
</ParamField>

<ParamField body="pin" type="string">
  Transaction PIN for additional security (if enabled)
</ParamField>

## Response Fields

<ResponseField name="status" type="enum" required>
  Response status: `SUCCESS` or `FAILED`
</ResponseField>

<ResponseField name="message" type="string">
  Error message if status is FAILED
</ResponseField>

<ResponseField name="data" type="object">
  Payment response data

  <Expandable title="data properties">
    <ResponseField name="amount" type="number">
      Principal amount that was paid
    </ResponseField>

    <ResponseField name="currency" type="string">
      Currency code of the payment
    </ResponseField>

    <ResponseField name="responseCode" type="string">
      HTTP response code as string
    </ResponseField>

    <ResponseField name="payableType" type="string">
      Type of the payable item
    </ResponseField>

    <ResponseField name="payAbleId" type="string">
      ID of the payable item
    </ResponseField>

    <ResponseField name="taxAmount" type="number">
      Tax amount applied
    </ResponseField>

    <ResponseField name="transactionFeeAmount" type="number">
      Transaction fee amount
    </ResponseField>

    <ResponseField name="paymentMethodFeeAmount" type="number">
      Payment method specific fee (usually 0 for wallet)
    </ResponseField>

    <ResponseField name="totalCheckOutAmount" type="number">
      Total amount debited from wallet
    </ResponseField>

    <ResponseField name="paymentStatus" type="enum">
      Current payment status
      
      **Options:**
      - `PAID` - Payment successful
      - `FAILED` - Payment failed
      - `PENDING` - Payment processing
    </ResponseField>

    <ResponseField name="countryIsoCode3" type="string">
      Three-letter country code
    </ResponseField>

    <ResponseField name="pcn" type="string">
      Payment Control Number
    </ResponseField>

    <ResponseField name="transactionType" type="enum">
      Type of transaction
      
      **Options:** `WALLET`, `ACCOUNTPAYMENT`, `CASHPICKUP`, `MOBILE_MONEY`
    </ResponseField>
  </Expandable>
</ResponseField>

## Request Example

<CodeGroup>

```bash cURL
curl --request POST \
  --url https://remitjunction.fincode.software/api/v6/services/paymentmanagement/makepaymentfromwalletaccount \
  --header 'Content-Type: application/json' \
  --header 'X-Auth-Token: your_auth_token' \
  --header 'uuid: device_uuid' \
  --header 'platform: WEB' \
  --data '{
    "payableType": "TRANSACTION",
    "payAbleId": "txn_abc123",
    "password": "user_password",
    "accountId": "wallet_456",
    "totalCheckOutAmount": 105.50,
    "paymentGatewayRef": "ref_789",
    "accountNumber": "1234567890",
    "paymentAccountNumbeCurrencyCode": "USD",
    "pin": "1234"
  }'
```

```javascript JavaScript
const payFromWallet = async (paymentData) => {
  const response = await fetch('https://remitjunction.fincode.software/api/v6/services/paymentmanagement/makepaymentfromwalletaccount', {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'X-Auth-Token': 'your_auth_token',
      'uuid': 'device_uuid',
      'platform': 'WEB'
    },
    body: JSON.stringify({
      payableType: 'TRANSACTION',
      payAbleId: 'txn_abc123',
      password: 'user_password',
      accountId: 'wallet_456',
      totalCheckOutAmount: 105.50,
      paymentGatewayRef: 'ref_789',
      accountNumber: '1234567890',
      paymentAccountNumbeCurrencyCode: 'USD',
      pin: '1234'
    })
  });

  return await response.json();
};
```

```python Python
import requests

url = "https://remitjunction.fincode.software/api/v6/services/paymentmanagement/makepaymentfromwalletaccount"
headers = {
    "Content-Type": "application/json",
    "X-Auth-Token": "your_auth_token",
    "uuid": "device_uuid",
    "platform": "WEB"
}
payload = {
    "payableType": "TRANSACTION",
    "payAbleId": "txn_abc123",
    "password": "user_password",
    "accountId": "wallet_456",
    "totalCheckOutAmount": 105.50,
    "paymentGatewayRef": "ref_789",
    "accountNumber": "1234567890",
    "paymentAccountNumbeCurrencyCode": "USD",
    "pin": "1234"
}

response = requests.post(url, json=payload, headers=headers)
data = response.json()
```

</CodeGroup>

## Response Example

<CodeGroup>

```json 200 OK - Success
{
  "status": "SUCCESS",
  "data": {
    "amount": 100.00,
    "currency": "USD",
    "responseCode": "200",
    "payableType": "TRANSACTION",
    "payAbleId": "txn_abc123",
    "taxAmount": 0.50,
    "transactionFeeAmount": 5.00,
    "paymentMethodFeeAmount": 0.00,
    "totalCheckOutAmount": 105.50,
    "paymentStatus": "PAID",
    "countryIsoCode3": "USA",
    "pcn": "PCN123456789",
    "transactionType": "WALLET"
  },
  "responseCode": 200
}
```

```json 401 Unauthorized
{
  "status": "FAILED",
  "message": "Invalid device info.",
  "responseCode": 401
}
```

```json 500 Insufficient Balance
{
  "status": "FAILED",
  "message": "Insufficient wallet balance. Available: 50.00 USD, Required: 105.50 USD",
  "responseCode": 500
}
```

```json 500 Invalid PIN
{
  "status": "FAILED",
  "message": "Please Enter The correct PIN",
  "responseCode": 500
}
```

```json 500 Invalid OTP
{
  "status": "FAILED",
  "message": "Please Enter An OTP to proceed with this transaction",
  "responseCode": 500
}
```

</CodeGroup>

## Security Features

### Strong Customer Authentication (SCA)

If enabled by the organization, customers must provide a One-Time Password (OTP):

```javascript
// Check if SCA is enabled
if (organization.strongCustomerAuthenticationEnabled) {
  // Request OTP first
  const otp = await requestOTP(customerId);
  
  // Include OTP in payment request
  paymentData.otp = otp;
}
```

### Transaction PIN

If PIN verification is mandatory:

```javascript
// Check if PIN is required
if (organization.enableTransactionPin) {
  // Prompt customer for PIN
  const pin = await promptForPIN();
  
  // Include PIN in payment request
  paymentData.pin = pin;
}
```

## Use Cases

### 1. Pay for Money Transfer

```javascript
const payForRemittance = async (transactionId) => {
  // First, get payment methods to confirm wallet balance
  const methods = await getPaymentMethods(transactionPCN);
  const walletMethod = methods.data.paymentMethodsMetadata
    .find(m => m.paymentMethod === 'E_WALLET');
  
  if (!walletMethod.metadata.sufficient) {
    throw new Error('Insufficient wallet balance');
  }
  
  // Process payment from wallet
  const payment = await fetch('/makepaymentfromwalletaccount', {
    method: 'POST',
    headers: headers,
    body: JSON.stringify({
      payableType: 'TRANSACTION',
      payAbleId: transactionId,
      password: userPassword,
      accountId: walletAccountId,
      totalCheckOutAmount: walletMethod.totalAmount,
      paymentGatewayRef: generateRef(),
      paymentAccountNumbeCurrencyCode: 'USD'
    })
  });
  
  return await payment.json();
};
```

### 2. Pay Bill from Wallet

```javascript
const payBill = async (billId, amount) => {
  const response = await fetch('/makepaymentfromwalletaccount', {
    method: 'POST',
    headers: headers,
    body: JSON.stringify({
      payableType: 'BILL',
      payAbleId: billId,
      password: userPassword,
      accountId: walletAccountId,
      totalCheckOutAmount: amount,
      paymentGatewayRef: `BILL_${Date.now()}`,
      paymentAccountNumbeCurrencyCode: 'NGN',
      pin: transactionPIN
    })
  });
  
  const result = await response.json();
  
  if (result.status === 'SUCCESS') {
    console.log('Bill paid successfully');
  }
  
  return result;
};
```

### 3. Fund Another Wallet

```javascript
const fundWallet = async (fundingRequestId) => {
  const response = await fetch('/makepaymentfromwalletaccount', {
    method: 'POST',
    headers: headers,
    body: JSON.stringify({
      payableType: 'WALLET_CUSTOMER',
      payAbleId: fundingRequestId,
      password: userPassword,
      accountId: sourceWalletId,
      totalCheckOutAmount: fundingAmount,
      paymentGatewayRef: `FUND_${Date.now()}`,
      accountNumber: sourceAccountNumber,
      paymentAccountNumbeCurrencyCode: 'USD'
    })
  });
  
  return await response.json();
};
```

## Error Handling

<ResponseExample>

```javascript Comprehensive Error Handling
const processWalletPayment = async (paymentData) => {
  try {
    const response = await fetch('/makepaymentfromwalletaccount', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'X-Auth-Token': token,
        'uuid': deviceId,
        'platform': 'WEB'
      },
      body: JSON.stringify(paymentData)
    });

    const result = await response.json();

    if (result.status === 'FAILED') {
      // Handle specific error cases
      if (result.message.includes('Insufficient wallet balance')) {
        return {
          error: 'INSUFFICIENT_FUNDS',
          message: 'Please fund your wallet to continue',
          requiredAmount: extractRequiredAmount(result.message)
        };
      }
      
      if (result.message.includes('Invalid device info')) {
        return {
          error: 'AUTH_FAILED',
          message: 'Please log in again'
        };
      }
      
      if (result.message.includes('correct PIN')) {
        return {
          error: 'INVALID_PIN',
          message: 'Incorrect transaction PIN',
          attemptsRemaining: 3
        };
      }
      
      if (result.message.includes('OTP')) {
        return {
          error: 'OTP_REQUIRED',
          message: 'Please enter the OTP sent to your phone'
        };
      }
      
      if (result.message.includes('matching available payable item')) {
        return {
          error: 'PAYABLE_NOT_FOUND',
          message: 'Payment item not found or expired'
        };
      }
      
      // Generic error
      return {
        error: 'PAYMENT_FAILED',
        message: result.message
      };
    }

    // Success
    return {
      success: true,
      payment: result.data
    };

  } catch (error) {
    // Network or parsing error
    return {
      error: 'NETWORK_ERROR',
      message: 'Unable to process payment. Please try again.'
    };
  }
};

// Usage
const result = await processWalletPayment(paymentData);

if (result.error) {
  switch (result.error) {
    case 'INSUFFICIENT_FUNDS':
      showFundWalletOption(result.requiredAmount);
      break;
    case 'INVALID_PIN':
      promptForPIN(result.attemptsRemaining);
      break;
    case 'OTP_REQUIRED':
      requestOTP();
      break;
    default:
      showErrorMessage(result.message);
  }
} else {
  // Payment successful
  showSuccessMessage(result.payment);
}
```

</ResponseExample>

## Important Notes

<Warning>
  - **Authentication Required**: Valid auth token and password must be provided
  - **Sufficient Balance**: Wallet must have enough balance to cover total checkout amount
  - **Payable Item**: Must exist and be in PENDING_PAYMENT status
  - **Security**: PIN/OTP may be required based on organization settings
  - **Currency Match**: Wallet currency must match the payable item currency
</Warning>

<Info>
  - **Instant Processing**: Wallet payments are processed immediately
  - **No Additional Fees**: Wallet payments typically have no payment method fees
  - **Transaction Rollback**: Failed payments are automatically rolled back
  - **Session Management**: User session is logged out after successful payment
</Info>

## Best Practices

### 1. Check Balance First

Always verify sufficient balance before attempting payment:

```javascript
// Get supported payment methods first
const methods = await getSupportedPaymentMethods(pcn);
const walletOption = methods.data.paymentMethodsMetadata
  .find(m => m.paymentMethod === 'E_WALLET');

if (walletOption && walletOption.metadata.sufficient) {
  // Proceed with wallet payment
  await makeWalletPayment(paymentData);
} else {
  // Show alternative payment methods
  showAlternativePayments(methods.data.paymentMethodsMetadata);
}
```

### 2. Handle Security Gracefully

Implement user-friendly security flows:

```javascript
const secureWalletPayment = async (paymentData) => {
  // Check if OTP is required
  if (orgSettings.strongCustomerAuthenticationEnabled) {
    const otp = await showOTPDialog();
    paymentData.otp = otp;
  }
  
  // Check if PIN is required
  if (orgSettings.enableTransactionPin) {
    const pin = await showPINDialog();
    paymentData.pin = pin;
  }
  
  return await makeWalletPayment(paymentData);
};
```

### 3. Provide Clear Feedback

```javascript
const processPaymentWithFeedback = async (paymentData) => {
  showLoadingIndicator('Processing payment...');
  
  try {
    const result = await makeWalletPayment(paymentData);
    
    if (result.status === 'SUCCESS') {
      hideLoadingIndicator();
      showSuccessMessage({
        title: 'Payment Successful',
        amount: result.data.amount,
        currency: result.data.currency,
        pcn: result.data.pcn
      });
    }
  } catch (error) {
    hideLoadingIndicator();
    showErrorMessage(error.message);
  }
};
```

## Next Steps

<CardGroup cols={1}>
  <Card title="Alternative Payment Methods" href="/api/deposit-engine/process-card-payment">
    Process card payment if wallet insufficient
  </Card>
</CardGroup>